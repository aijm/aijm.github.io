<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>vscode java 配置</title>
      <link href="/2018/12/28/vscode-java-%E9%85%8D%E7%BD%AE/"/>
      <url>/2018/12/28/vscode-java-%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://code.visualstudio.com/docs/languages/java" target="_blank" rel="noopener">java in vscode</a></p></blockquote><h2 id="插件安装"><a href="#插件安装" class="headerlink" title="插件安装"></a>插件安装</h2><p>安装 <strong>Java Extension Pack</strong> 插件,会自动安装以下四个插件：</p><ul><li>Language Support for Java(TM) by Red Hat</li><li>Debugger for Java</li><li>Java Test Runner</li><li>Maven for Java<br>在vscode中可以通过以上插件配置java编程环境。但是如果不用maven、gradle等项目构建工具，后两个插件是无法使用的，而且对于简单的仅有.java文件的项目结构，就我找遍各种资料，也没有找到导入jar包的方法，自动识别文件内容有时也会出错。<h2 id="配置jdk路径"><a href="#配置jdk路径" class="headerlink" title="配置jdk路径"></a>配置jdk路径</h2>打开settings.json，在用户设置中添加 <code>&quot;java.home&quot;: &quot;D:\\Program Files\\Java\\jdk-11.0.1&quot;</code>，<a id="more"></a><h2 id="run-and-debug"><a href="#run-and-debug" class="headerlink" title="run and debug"></a>run and debug</h2></li></ul><ol><li>找不到依赖文件<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NBody</span></span>&#123;</span><br><span class="line">    <span class="comment">/** return the radius of the universe in file */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">readRadius</span><span class="params">(String filename)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> radius=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            In in = <span class="keyword">new</span> In(filename);</span><br><span class="line">            in.readInt();</span><br><span class="line">            radius = in.readDouble();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// System.out.println("Read file " + filename + " successful!");</span></span><br><span class="line">        <span class="keyword">return</span> radius;      </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** return an array of planets from file */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Planet[] readPlanets(String filename)&#123;</span><br><span class="line">        Planet[] planets = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            In in = <span class="keyword">new</span> In(filename);</span><br><span class="line">            <span class="keyword">int</span> N = in.readInt();</span><br><span class="line">            in.readDouble();</span><br><span class="line">            <span class="comment">/** construct planets array */</span></span><br><span class="line">            planets = <span class="keyword">new</span> Planet[N];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;N;i++)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">double</span> xP = in.readDouble();</span><br><span class="line">                <span class="keyword">double</span> yP = in.readDouble();</span><br><span class="line">                <span class="keyword">double</span> xV = in.readDouble();</span><br><span class="line">                <span class="keyword">double</span> yV = in.readDouble();</span><br><span class="line">                <span class="keyword">double</span> m = in.readDouble();</span><br><span class="line">                String img = in.readString();</span><br><span class="line">                planets[i] = <span class="keyword">new</span> Planet(xP, yP, xV, yV, m, img);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"Read file "</span> + filename + <span class="string">" successful!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception e)&#123;System.out.println(e);&#125;</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> planets;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> T = Double.parseDouble(args[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">double</span> dt = Double.parseDouble(args[<span class="number">1</span>]);</span><br><span class="line">        String filename = args[<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">double</span> radius = readRadius(filename);</span><br><span class="line">        Planet[] planets = readPlanets(filename);</span><br><span class="line">        StdAudio.play(<span class="string">"./audio/2001.mid"</span>);</span><br><span class="line"></span><br><span class="line">        StdDraw.setScale(-radius,radius);</span><br><span class="line">        StdDraw.enableDoubleBuffering();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">double</span> time = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(time &lt; T)&#123;</span><br><span class="line">            <span class="keyword">double</span>[] xForces = <span class="keyword">new</span> <span class="keyword">double</span>[planets.length];</span><br><span class="line">            <span class="keyword">double</span>[] yForces = <span class="keyword">new</span> <span class="keyword">double</span>[planets.length];</span><br><span class="line">            <span class="comment">/** save the forces to xForces and yFroces arrays */</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;planets.length;i++)&#123;</span><br><span class="line">                xForces[i] = planets[i].calcNetForceExertedByX(planets);</span><br><span class="line">                yForces[i] = planets[i].calcNetForceExertedByY(planets);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/** update all planets */</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;planets.length;i++)&#123;</span><br><span class="line">                planets[i].update(dt, xForces[i], yForces[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            StdDraw.clear();</span><br><span class="line">            <span class="comment">/** draw image background */</span></span><br><span class="line">            StdDraw.picture(<span class="number">0</span>, <span class="number">0</span>, <span class="string">"./images/starfield.jpg"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">/** draw all the planets */</span></span><br><span class="line">            <span class="keyword">for</span>(Planet p : planets)&#123;</span><br><span class="line">                p.draw();</span><br><span class="line">            &#125;</span><br><span class="line">            StdDraw.show();</span><br><span class="line">            StdDraw.pause(<span class="number">10</span>);</span><br><span class="line">            time += dt;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        StdOut.printf(<span class="string">"%d\n"</span>, planets.length);</span><br><span class="line">        StdOut.printf(<span class="string">"%.2e\n"</span>, radius);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; planets.length; i++) &#123;</span><br><span class="line">                StdOut.printf(<span class="string">"%11.4e %11.4e %11.4e %11.4e %11.4e %12s\n"</span>,</span><br><span class="line">                        planets[i].xxPos, planets[i].yyPos, planets[i].xxVel,</span><br><span class="line">                        planets[i].yyVel, planets[i].mass, planets[i].imgFileName);   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>上面的java程序依赖<code>In, Planet, StdAudio,StdDraw,StdOut</code> 而进行Run/Debug时会报错，找不到<code>In,StdAudio</code>等，但是把对应java文件双击打开后，运行正常。</p><ol start="2"><li>需要命令行参数，则配置launch.json中的”args”<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"configurations"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"java"</span>,</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"CodeLens (Launch) - NBody"</span>,</span><br><span class="line">            <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">            <span class="attr">"mainClass"</span>: <span class="string">"NBody"</span>,</span><br><span class="line">            <span class="attr">"args"</span>: <span class="string">"157788000.0 25000.0 data/planets.txt"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="library-path"><a href="#library-path" class="headerlink" title="library path"></a>library path</h2><p>不用maven什么的话，现在没有办法加载库，通过calssPath也不行。</p>]]></content>
      
      
      <categories>
          
          <category> vscode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cs61c project1-1 Shape from Stereo, in C</title>
      <link href="/2018/12/26/cs61c-project1-1-Shape-from-Stereo-in-C/"/>
      <url>/2018/12/26/cs61c-project1-1-Shape-from-Stereo-in-C/</url>
      
        <content type="html"><![CDATA[<h2 id="CUnit"><a href="#CUnit" class="headerlink" title="CUnit"></a>CUnit</h2>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>cs61c_hw2</title>
      <link href="/2018/12/25/cs61c-hw2/"/>
      <url>/2018/12/25/cs61c-hw2/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>cs61c_lab3-RISC-V</title>
      <link href="/2018/12/25/cs61c-lab3/"/>
      <url>/2018/12/25/cs61c-lab3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>link of cs61c_lab3 <a href="http://inst.eecs.berkeley.edu/~cs61c/fa18/labs/3/" target="_blank" rel="noopener">lab3</a></p></blockquote><p><strong>lab3_ex1.s</strong><br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">.data</span></span><br><span class="line"><span class="meta">.word</span> <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span></span><br><span class="line">n: <span class="meta">.word</span> <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="meta">.text</span></span><br><span class="line"><span class="symbol">main:</span>   <span class="keyword">add </span>    <span class="built_in">t0</span>, x0, x0</span><br><span class="line">        <span class="keyword">addi </span>   <span class="built_in">t1</span>, x0, <span class="number">1</span></span><br><span class="line">        la      <span class="built_in">t3</span>, n</span><br><span class="line">        <span class="keyword">lw </span>     <span class="built_in">t3</span>, <span class="number">0</span>(<span class="built_in">t3</span>)</span><br><span class="line"><span class="symbol">fib:</span>    <span class="keyword">beq </span>    <span class="built_in">t3</span>, x0, finish</span><br><span class="line">        <span class="keyword">add </span>    <span class="built_in">t2</span>, <span class="built_in">t1</span>, <span class="built_in">t0</span></span><br><span class="line">        mv      <span class="built_in">t0</span>, <span class="built_in">t1</span></span><br><span class="line">        mv      <span class="built_in">t1</span>, <span class="built_in">t2</span></span><br><span class="line">        <span class="keyword">addi </span>   <span class="built_in">t3</span>, <span class="built_in">t3</span>, -<span class="number">1</span></span><br><span class="line">        <span class="keyword">j </span>      fib</span><br><span class="line"><span class="symbol">finish:</span> <span class="keyword">addi </span>   <span class="built_in">a0</span>, x0, <span class="number">1</span></span><br><span class="line">        <span class="keyword">addi </span>   <span class="built_in">a1</span>, <span class="built_in">t0</span>, <span class="number">0</span></span><br><span class="line">        ecall <span class="comment"># print integer ecall</span></span><br><span class="line">        <span class="keyword">addi </span>   <span class="built_in">a0</span>, x0, <span class="number">10</span></span><br><span class="line">        ecall <span class="comment"># terminate ecall</span></span><br></pre></td></tr></table></figure></p><h1 id="Exercise-1-Familiarizing-yourself-with-Venus"><a href="#Exercise-1-Familiarizing-yourself-with-Venus" class="headerlink" title="Exercise 1: Familiarizing yourself with Venus"></a>Exercise 1: Familiarizing yourself with Venus</h1><a id="more"></a><ol><li>What do the .data, .word, .text directives mean (i.e. what do you use them for)? Hint: think about the 4 sections of memory.<blockquote><p>.data 是表示 static data 区域，而其中的.word表示静态全局数据区域的32位字；.text表示指令区域</p></blockquote></li><li>Run the program to completion. What number did the program output? What does this number represent?<blockquote><p>34， 菲波那切数列中的第9个(从0开始数)。 0,1,1,2,3,5,8,13,21,34</p></blockquote></li><li>At what address is n stored in memory? Hint: Look at the contents of the registers.<blockquote><p>0x10000010</p></blockquote></li><li>Without using the “Edit” tab, have the program calculate the 13th fib number (0-indexed) by manually modifying the value of a register. You may find it helpful to first step through the code. If you prefer to look at decimal values, change the “Display Settings” option at the bottom.<blockquote><p>只需在 lw t3, 0(t3) 之后把寄存器 x28 的值改为 0x0000000D,即13</p></blockquote></li></ol><h1 id="Exercise-2-Translating-from-C-to-RISC-V"><a href="#Exercise-2-Translating-from-C-to-RISC-V" class="headerlink" title="Exercise 2: Translating from C to RISC-V"></a>Exercise 2: Translating from C to RISC-V</h1><p>Task: Find/explain the following components of this assembly file.<br><strong>lab3_ex2_assembly.s</strong><br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">.data</span></span><br><span class="line"><span class="symbol">source:</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">3</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">1</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">4</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">1</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">5</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">9</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line"><span class="symbol">dest:</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line">    <span class="meta">.word</span>   <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">.text</span></span><br><span class="line"><span class="symbol">main:</span></span><br><span class="line">    <span class="keyword">addi </span><span class="built_in">t0</span>, x0, <span class="number">0</span> <span class="comment"># int k = 0;</span></span><br><span class="line">    la <span class="built_in">t1</span>, source  <span class="comment"># pointer to source</span></span><br><span class="line">    la <span class="built_in">t2</span>, dest    <span class="comment"># pointer to dest</span></span><br><span class="line"><span class="symbol">loop:</span></span><br><span class="line">    <span class="keyword">slli </span><span class="built_in">t3</span>, <span class="built_in">t0</span>, <span class="number">2</span> <span class="comment"># 32bit,so offset is 4*k</span></span><br><span class="line">    <span class="keyword">add </span><span class="built_in">t4</span>, <span class="built_in">t1</span>, <span class="built_in">t3</span> </span><br><span class="line">    <span class="keyword">lw </span><span class="built_in">t5</span>, <span class="number">0</span>(<span class="built_in">t4</span>)     <span class="comment"># int temp = source[k];</span></span><br><span class="line">    <span class="keyword">beq </span><span class="built_in">t5</span>, x0, exit <span class="comment"># while(source[k]!=0)</span></span><br><span class="line">    <span class="keyword">add </span><span class="built_in">t6</span>, <span class="built_in">t2</span>, <span class="built_in">t3</span>   </span><br><span class="line">    <span class="keyword">sw </span><span class="built_in">t5</span>, <span class="number">0</span>(<span class="built_in">t6</span>)     <span class="comment"># dest[k] = temp;</span></span><br><span class="line">    <span class="keyword">addi </span><span class="built_in">t0</span>, <span class="built_in">t0</span>, <span class="number">1</span>   <span class="comment"># k++;</span></span><br><span class="line">    <span class="keyword">jal </span>x0, loop  </span><br><span class="line"><span class="symbol">exit:</span></span><br><span class="line">    <span class="keyword">addi </span><span class="built_in">a0</span>, x0, <span class="number">10</span></span><br><span class="line">    <span class="keyword">add </span><span class="built_in">a1</span>, x0, x0</span><br><span class="line">    ecall <span class="comment"># Terminate ecall</span></span><br></pre></td></tr></table></figure></p><ol><li>The register representing the variable k.<blockquote><p>t0</p></blockquote></li><li>The registers acting as pointers to the source and dest arrays.<blockquote><p>t1 –&gt; source, t2 –&gt; dest</p></blockquote></li><li><p>The assembly code for the loop found in the C code.</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">loop:</span></span><br><span class="line">    <span class="keyword">slli </span><span class="built_in">t3</span>, <span class="built_in">t0</span>, <span class="number">2</span> <span class="comment"># 32bit,so offset is 4*k</span></span><br><span class="line">    <span class="keyword">add </span><span class="built_in">t4</span>, <span class="built_in">t1</span>, <span class="built_in">t3</span> </span><br><span class="line">    <span class="keyword">lw </span><span class="built_in">t5</span>, <span class="number">0</span>(<span class="built_in">t4</span>)     <span class="comment"># int temp = source[k];</span></span><br><span class="line">    <span class="keyword">beq </span><span class="built_in">t5</span>, x0, exit <span class="comment"># while(source[k]!=0)</span></span><br><span class="line">    <span class="keyword">add </span><span class="built_in">t6</span>, <span class="built_in">t2</span>, <span class="built_in">t3</span>   </span><br><span class="line">    <span class="keyword">sw </span><span class="built_in">t5</span>, <span class="number">0</span>(<span class="built_in">t6</span>)     <span class="comment"># dest[k] = temp;</span></span><br><span class="line">    <span class="keyword">addi </span><span class="built_in">t0</span>, <span class="built_in">t0</span>, <span class="number">1</span>   <span class="comment"># k++;</span></span><br><span class="line">    <span class="keyword">jal </span>x0, loop</span><br></pre></td></tr></table></figure></li><li><p>How the pointers are manipulated in the assembly code.</p><blockquote><p>&amp;取地址，用la, 地址存在寄存器中，通过地址加减移位运算移动指针，通过lw,sw来实现取值和赋值</p></blockquote></li></ol><h1 id="Exercise-4-RISC-V-function-calling-with-map"><a href="#Exercise-4-RISC-V-function-calling-with-map" class="headerlink" title="Exercise 4: RISC-V function calling with map"></a>Exercise 4: RISC-V function calling with map</h1><p>C语言形式：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">void map(node *head, int (*f)(int))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!head)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    head-&gt;value = f(head-&gt;value);</span><br><span class="line">    <span class="built_in">map</span>(head-&gt;next,f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>用RISC-V来写以上代码，下文仅包含简略部分：<br>关键点：</p><h2 id="函数调用步骤"><a href="#函数调用步骤" class="headerlink" title="函数调用步骤"></a>函数调用步骤</h2><p><img src="/images/stack.png" alt=""></p><ul><li>参数存入a0,a1,…</li><li>调用时需要保存return address, 需要保存的寄存器的值；存储这些值是因为调用的函数可能会改变这些值。</li><li>上面的值通过栈来保存，就是所谓的调用栈</li><li>通过 <code>jal ra, func</code> 调用函数，这条语句会把ra的值+4,得到下一条指令的地址，同时把pc的值变为函数func的地址</li><li>执行函数，通过<code>a0</code>返回值，在最后 <code>jr ra</code>, 会将pc的值变为ra,返回到之前调用处的下一条指令</li><li>函数调用后，从栈中恢复原来保存的值，通过sp增加回收栈空间</li></ul><p>例如以下是调用<code>f(head-&gt;value)</code>的RISC-V代码<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">addi </span><span class="built_in">sp</span>, <span class="built_in">sp</span>, -<span class="number">4</span></span><br><span class="line"><span class="keyword">sw </span><span class="built_in">ra</span>, <span class="number">0</span>(<span class="built_in">sp</span>) <span class="comment"># save ra</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">lw </span><span class="built_in">a0</span>, <span class="number">0</span>(<span class="built_in">s0</span>) <span class="comment"># node value as aug</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">jalr </span><span class="built_in">ra</span>, <span class="built_in">a1</span>, <span class="number">0</span>  <span class="comment"># fun(node value)</span></span><br><span class="line"><span class="keyword">lw </span><span class="built_in">ra</span>, <span class="number">0</span>(<span class="built_in">sp</span>)    <span class="comment"># restore ra</span></span><br><span class="line"><span class="keyword">addi </span><span class="built_in">sp</span>, <span class="built_in">sp</span>, <span class="number">4</span>  <span class="comment"># toss off stack</span></span><br></pre></td></tr></table></figure></p><h2 id="尾调用"><a href="#尾调用" class="headerlink" title="尾调用"></a>尾调用</h2><p>例如类似以下函数：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// example1</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> g(a,b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// example2</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>+g(a,b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>example1中函数g(a,b)调用后就返回，所以不需要产生调用栈，直接调用g,<code>jal x0, g</code>,然后在g(a,b)中 <code>jr ra</code>即可。</p><h2 id="尾递归"><a href="#尾递归" class="headerlink" title="尾递归"></a>尾递归</h2><p>尾递归就是递归调用是尾调用的递归。普通的递归程序由于不断调用产生调用栈，调用层数太多时容易产生栈溢出，而尾递归却不会。比如map程序就是一个尾递归，内部调用时应该用<code>jal x0, map</code>, 而不是<code>jal ra,map</code><br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">map:</span></span><br><span class="line">    <span class="keyword">beq </span><span class="built_in">a0</span>, x0, done    <span class="comment"># If we were given a null pointer (address 0), we're done.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">add </span><span class="built_in">s0</span>, <span class="built_in">a0</span>, x0  <span class="comment"># Save address of this node in s0</span></span><br><span class="line">    <span class="keyword">add </span><span class="built_in">s1</span>, <span class="built_in">a1</span>, x0  <span class="comment"># Save address of function in s1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># load the value of the current node into a0</span></span><br><span class="line">    <span class="keyword">lw </span><span class="built_in">a0</span>, <span class="number">0</span>(<span class="built_in">s0</span>) <span class="comment"># node value as aug</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 调用函数f,产生调用栈</span></span><br><span class="line">    <span class="keyword">addi </span><span class="built_in">sp</span>, <span class="built_in">sp</span>, -<span class="number">4</span></span><br><span class="line">    <span class="keyword">sw </span><span class="built_in">ra</span>, <span class="number">0</span>(<span class="built_in">sp</span>) <span class="comment"># func call need to save ra</span></span><br><span class="line">    <span class="keyword">jalr </span><span class="built_in">ra</span>, <span class="built_in">a1</span>, <span class="number">0</span>  <span class="comment"># fun(node value)</span></span><br><span class="line">    <span class="keyword">lw </span><span class="built_in">ra</span>, <span class="number">0</span>(<span class="built_in">sp</span>)    <span class="comment"># restore ra</span></span><br><span class="line">    <span class="keyword">addi </span><span class="built_in">sp</span>, <span class="built_in">sp</span>, <span class="number">4</span>  <span class="comment"># toss off stack</span></span><br><span class="line">    <span class="comment"># store the returned value back into the node</span></span><br><span class="line">    <span class="keyword">sw </span><span class="built_in">a0</span>, <span class="number">0</span>(<span class="built_in">s0</span>) <span class="comment"># change node value</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Load the address of the next node into a0</span></span><br><span class="line">    <span class="keyword">lw </span><span class="built_in">a0</span>, <span class="number">4</span>(<span class="built_in">s0</span>) <span class="comment"># next node </span></span><br><span class="line">    mv <span class="built_in">a1</span>, <span class="built_in">s1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">jal </span>x0, map <span class="comment"># 尾调用不需要用栈存储返回地址、寄存器值，不会产生调用栈</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">done:</span></span><br><span class="line">    <span class="keyword">jr </span><span class="built_in">ra</span> <span class="comment"># Return to caller</span></span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> learn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cs61c </tag>
            
            <tag> 尾递归 </tag>
            
            <tag> RISC-V </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cs61c_lab2</title>
      <link href="/2018/12/25/cs61c-lab2/"/>
      <url>/2018/12/25/cs61c-lab2/</url>
      
        <content type="html"><![CDATA[<blockquote><p>link of cs61b lab2 <a href="http://inst.eecs.berkeley.edu/~cs61c/fa18/labs/2/" target="_blank" rel="noopener">lab2</a></p></blockquote><h1 id="Exercise1-Bit-Operations"><a href="#Exercise1-Bit-Operations" class="headerlink" title="Exercise1:Bit Operations"></a>Exercise1:Bit Operations</h1><p>给一个<code>unsigned int</code>的数，如何只通过与(&amp;), 或(|), 非(~), 异或(^), 逻辑左移(&lt;&lt;), 逻辑右移(&gt;&gt;),来实现三个函数。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Return the nth bit of x.</span></span><br><span class="line"><span class="comment">// Assume 0 &lt;= n &lt;= 31</span></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="title">get_bit</span><span class="params">(<span class="keyword">unsigned</span> x,</span></span></span><br><span class="line"><span class="function"><span class="params">                 <span class="keyword">unsigned</span> n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set the nth bit of the value of x to v.</span></span><br><span class="line"><span class="comment">// Assume 0 &lt;= n &lt;= 31, and v is 0 or 1</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">set_bit</span><span class="params">(<span class="keyword">unsigned</span> * x,</span></span></span><br><span class="line"><span class="function"><span class="params">             <span class="keyword">unsigned</span> n,</span></span></span><br><span class="line"><span class="function"><span class="params">             <span class="keyword">unsigned</span> v)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Flip the nth bit of the value of x.</span></span><br><span class="line"><span class="comment">// Assume 0 &lt;= n &lt;= 31</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">flip_bit</span><span class="params">(<span class="keyword">unsigned</span> * x,</span></span></span><br><span class="line"><span class="function"><span class="params">              <span class="keyword">unsigned</span> n)</span></span>;</span><br></pre></td></tr></table></figure></p><a id="more"></a><p>要实现这三个操作，关键是利用任何数与111…1进行与，结果是其自身。任何数与000…0进行或，结果是其自身。</p><h2 id="get-bit"><a href="#get-bit" class="headerlink" title="get_bit"></a>get_bit</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="title">get_bit</span><span class="params">(<span class="keyword">unsigned</span> x, <span class="keyword">unsigned</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x&gt;&gt;n) &amp; <span class="number">0x1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="set-bit"><a href="#set-bit" class="headerlink" title="set_bit"></a>set_bit</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">set_bit</span><span class="params">(<span class="keyword">unsigned</span> * x,</span></span></span><br><span class="line"><span class="function"><span class="params">             <span class="keyword">unsigned</span> n,</span></span></span><br><span class="line"><span class="function"><span class="params">             <span class="keyword">unsigned</span> v)</span></span></span><br><span class="line"><span class="function">             </span>&#123;</span><br><span class="line">                (*x) = (*x) &amp; ~(<span class="number">0x1</span> &lt;&lt; n); <span class="comment">// 和111...0...111与将n位置变成0</span></span><br><span class="line">                (*x) = (*x) | (v&lt;&lt;n); <span class="comment">// 和0000...v...0000或</span></span><br><span class="line">             &#125;</span><br></pre></td></tr></table></figure><h2 id="flip-bit"><a href="#flip-bit" class="headerlink" title="flip_bit"></a>flip_bit</h2><p>因为 1^1 = 0,1^0 = 1,所以 1^a = ~a,所以filp可以通过与1进行<code>^</code>操作实现；又因为1^0 = 1, 0^0 = 0, 所以 a^0 = a, 所以与0异或保持不变，则用mask <code>000...1...000</code>异或即可<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">flip_bit</span><span class="params">(<span class="keyword">unsigned</span> * x,</span></span></span><br><span class="line"><span class="function"><span class="params">              <span class="keyword">unsigned</span> n)</span></span></span><br><span class="line"><span class="function">              </span>&#123;</span><br><span class="line">                  (*x) = (*x) ^ (<span class="number">1</span>&lt;&lt;n);</span><br><span class="line">              &#125;</span><br></pre></td></tr></table></figure></p><h1 id="线性反馈移位寄存器"><a href="#线性反馈移位寄存器" class="headerlink" title="线性反馈移位寄存器"></a>线性反馈移位寄存器</h1><p>linear feedback shift register, 例如一个16位寄存器x，每次对各个位进行特定的线性运算，得到一个新的值a=0 或 1，然后x右移1位，首位变成a,如此不断运算，最后能遍历所有16位数，由于每次的操作具有一定的随机性，可以用于生成伪随机数。伪随机数是因为只要初始值给定，后面得到的每个值都是固定的，所以常常需要设置不同的初始值(随机数种子)。<br><img src="/images/LFSR-F18.gif" alt=""><br>例如上图，每次对0,2,3,5的位进行异或运算，移位后将最高位设为计算得到的值。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lfsr_calculate</span><span class="params">(<span class="keyword">uint16_t</span> *reg)</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint16_t</span> reg_0 = (*reg) &amp; <span class="number">0x1</span>u;</span><br><span class="line"><span class="keyword">uint16_t</span> reg_2 = ((*reg) &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x1</span>u;</span><br><span class="line"><span class="keyword">uint16_t</span> reg_3 = ((*reg) &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x1</span>u;</span><br><span class="line"><span class="keyword">uint16_t</span> reg_5 = ((*reg) &gt;&gt; <span class="number">5</span>) &amp; <span class="number">0x1</span>u;</span><br><span class="line"><span class="keyword">uint16_t</span> shift_in = ((reg_0^reg_2)^reg_3)^reg_5;</span><br><span class="line">*reg = *reg &gt;&gt; <span class="number">1</span>; <span class="comment">// right shift 1 bit</span></span><br><span class="line">*reg = (*reg) | (shift_in &lt;&lt; <span class="number">15</span>); <span class="comment">// shift in</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> learn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cs61c </tag>
            
            <tag> 线性反馈移位寄存器 </tag>
            
            <tag> 位操作 </tag>
            
            <tag> 伪随机数 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cs61c_lab1</title>
      <link href="/2018/12/23/cs61c-lab1/"/>
      <url>/2018/12/23/cs61c-lab1/</url>
      
        <content type="html"><![CDATA[<h3 id="Exercise-1-Binary-Alphabet"><a href="#Exercise-1-Binary-Alphabet" class="headerlink" title="Exercise 1: Binary Alphabet"></a>Exercise 1: Binary Alphabet</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0  1  1  0  □  ■  ■  □</span><br><span class="line">1  0  0 1  ■  □  □  ■</span><br><span class="line">1  1  1 1    --&gt;  ■  ■  ■  ■</span><br><span class="line">1  0  0 1  ■  □  □  ■</span><br><span class="line">1  0  0 1  ■  □  □  ■</span><br></pre></td></tr></table></figure><p>checkoff:</p><ul><li>What five decimal digits produce the pattern above? What five hexadecimal digits?</li><li>What letter is drawn with 1,1,9,9,6? 0xF8F88?</li><li>What is the hexadecimal representation you would use to spell the letter ‘B’? ‘N’ (you probably won’t want to use 5 hex digits for this one)?<a id="more"></a>answer:</li><li>十进制 6,9,15,9,9; 十六进制 0x6,0x9,0xF,0x9,0x9–&gt;0x69F99</li><li>1,1,9,9,6–&gt;<code>J</code>; 0xF8F88–&gt;<code>F</code></li><li>见图：0xE9E9E–&gt;<code>B</code>;0x9DB90–&gt;<code>N</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">B</span><br><span class="line">■  ■  ■  □</span><br><span class="line">■  □  □  ■</span><br><span class="line">■  ■  ■  □</span><br><span class="line">■  □  □  ■</span><br><span class="line">■  ■  ■  □</span><br><span class="line">N</span><br><span class="line">■  □  □  ■</span><br><span class="line">■  ■  □  ■</span><br><span class="line">■  □  ■  ■</span><br><span class="line">■  □  □  ■</span><br><span class="line">□  □  □  □</span><br></pre></td></tr></table></figure></li></ul><h3 id="Exercise-2-Simple-C-Program"><a href="#Exercise-2-Simple-C-Program" class="headerlink" title="Exercise 2: Simple C Program"></a>Exercise 2: Simple C Program</h3><p>checkoff:</p><ul><li>Explain the changes you made.</li><li>Explain the minimum number of distinct values needed for the preprocessor macros.</li><li>What does the -o flag do with gcc?</li></ul><p>answer:</p><ul><li>V0=3,V1=3,V3=3,V2!=0</li><li>3</li><li><code>gcc -o &lt;file&gt;</code> –&gt; Place the executable output into file</li></ul><h3 id="Exercise-3-Debugger"><a href="#Exercise-3-Debugger" class="headerlink" title="Exercise 3: Debugger"></a>Exercise 3: Debugger</h3><ol><li>How do you pass command line arguments to a program when using gdb?<br><code>run arg1 arg2 ...</code></li><li>How do you set a breakpoint which only occurs when a set of conditions is true (e.g. when certain variables are a certain value)?<br><code>b file:line if &lt;condition&gt;</code></li><li>How do you execute the next line of C code in the program after stopping at a breakpoint?<br><code>next</code></li><li>If the next line of code is a function call, you’ll execute the whole function call at once if you use your answer to #3. (If not, consider a different command for #3!) How do you tell GDB that you want to debug the code inside the function instead? (If you changed your answer to #3, then that answer is most likely now applicable here.)<br><code>step</code></li><li>How do you resume the program after stopping at a breakpoint?<br><code>INTERRUPT or Ctrl+c</code></li><li>How can you see the value of a variable (or even an expression like 1+2) in gdb?<br><code>p &lt;exp&gt;</code></li><li>How do you configure gdb so it prints the value of a variable after every step?<br><code>display &lt;variable&gt;</code></li><li>How do you print a list of all variables and their values in the current function?<br><code>info args, info locals, info variables</code></li><li>How do you exit out of gdb?<br><code>quit</code></li></ol><h3 id="Exercise-4-5-6"><a href="#Exercise-4-5-6" class="headerlink" title="Exercise 4,5,6"></a>Exercise 4,5,6</h3><ol><li>C program requires user input: how to run or gdb without geting stuck?<br>通过重定向方法，重定向输入输出流<code>stdin</code>和<code>stdout</code>为文件，如：<br><code>./a.out &lt; intput.txt &gt; output.txt</code>，对于gdb,则是<code>run &lt; input.txt &gt; output.txt</code></li><li>how to check if a linked list has a cycle? (tortoise and hare)</li></ol>]]></content>
      
      
      <categories>
          
          <category> learn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cs61c </tag>
            
            <tag> gdb </tag>
            
            <tag> cgdb </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cs61c_lab0</title>
      <link href="/2018/12/23/cs61c-lab0/"/>
      <url>/2018/12/23/cs61c-lab0/</url>
      
        <content type="html"><![CDATA[<h2 id="问题和任务"><a href="#问题和任务" class="headerlink" title="问题和任务"></a>问题和任务</h2><p>lab0给了一个文件夹，目录如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">aijm@DESKTOP-R8SS06A:/mnt/d/学习/cs61c/lab00$ tree -L 1</span><br><span class="line">.</span><br><span class="line">├── bin</span><br><span class="line">├── config</span><br><span class="line">└── user</span><br></pre></td></tr></table></figure></p><p>其中 bin 目录存储了一些程序，config 包含 users.list 和 users.list.bak, user 包含各个不同用户的目录，每个用户目录下都有init.d文件夹。</p><p>问题背景是，当黑客侵入系统时，会将他的username 加入到配置文件 users.list中，而users.list每次更改都会产生一个备份，users.list.bak.<br><a id="more"></a></p><h3 id="任务1：-找出侵入系统的用户"><a href="#任务1：-找出侵入系统的用户" class="headerlink" title="任务1： 找出侵入系统的用户"></a>任务1： 找出侵入系统的用户</h3><p>方法是比较users.list 和 users.list.bak,查看其中的不同,可以使用 <code>diff</code> 和 <code>sdiff</code>命令：</p><h4 id="sdiff"><a href="#sdiff" class="headerlink" title="sdiff"></a>sdiff</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usage: sdiff [  -l | -s ][  -o OutFile] [  -w Number ]File1 File2</span><br></pre></td></tr></table></figure><p>则通过 -s 选项仅仅输出不同的行：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aijm@DESKTOP-R8SS06A:/mnt/d/学习/cs61c/lab00/config$ sdiff -s users.list users.list.bak</span><br><span class="line">sonicspaceman</span><br></pre></td></tr></table></figure></p><p>则可以知道，入侵者的用户名是: <strong>sonicspaceman</strong>,一个非常骚气的名字。。。</p><p>这个入侵者可能会修改已有的程序，或者植入自己的程序，我们需要找出bin目录下的这些程序。</p><h3 id="任务2：-找出入侵者可能修改、植入的程序"><a href="#任务2：-找出入侵者可能修改、植入的程序" class="headerlink" title="任务2： 找出入侵者可能修改、植入的程序"></a>任务2： 找出入侵者可能修改、植入的程序</h3><p>方法是通过查看users.list的修改时间，再看bin目录下程序的修改时间，找出可能的程序。</p><p>通过<code>stat</code>命令查看文件时间戳：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">aijm@DESKTOP-R8SS06A:/mnt/d/学习/cs61c/lab00/config$ <span class="built_in">stat</span> *</span><br><span class="line">  File: users.list</span><br><span class="line">  Size: 91687           Blocks: 184        IO Block: 4096   regular file</span><br><span class="line">Device: dh/13d  Inode: 562949954017106  Links: 1</span><br><span class="line">Access: (0777/-rwxrwxrwx)  Uid: ( 1000/    aijm)   Gid: ( 1000/    aijm)</span><br><span class="line">Access: 2018-12-23 01:23:28.098195800 +0800</span><br><span class="line">Modify: 2018-08-21 06:41:30.000000000 +0800</span><br><span class="line">Change: 2018-12-23 00:07:05.114099700 +0800</span><br><span class="line"> Birth: -</span><br><span class="line">  File: users.list.bak</span><br><span class="line">  Size: 91673           Blocks: 184        IO Block: 4096   regular file</span><br><span class="line">Device: dh/13d  Inode: 562949954017107  Links: 1</span><br><span class="line">Access: (0777/-rwxrwxrwx)  Uid: ( 1000/    aijm)   Gid: ( 1000/    aijm)</span><br><span class="line">Access: 2018-12-23 01:22:12.619836900 +0800</span><br><span class="line">Modify: 2018-08-21 06:40:48.000000000 +0800</span><br><span class="line">Change: 2018-12-23 00:07:05.114099700 +0800</span><br><span class="line"> Birth: -</span><br></pre></td></tr></table></figure></p><p>可以看到 users.list 在 <strong>Modify: 2018-08-21 06:41:30.000000000 +0800</strong> 被修改，于是在bin目录下，可以让文件按修改时间进行排序：<br>用 <code>ls -lat</code>,按修改时间排序：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">aijm@DESKTOP-R8SS06A:/mnt/d/学习/cs61c/lab00/bin$ ls -lat</span><br><span class="line">total 4116</span><br><span class="line">drwxrwxrwx 1 aijm aijm    4096 Dec 23 00:08 ..</span><br><span class="line">drwxrwxrwx 1 aijm aijm    4096 Dec 23 00:08 .</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  182352 Aug 21 06:44 dog</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  182352 Aug 21 06:43 sudo</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   34888 Aug 21 06:39 bzip2</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   59608 Aug 21 06:39 chmod</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   67768 Aug 21 06:39 chown</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   72000 Aug 21 06:39 dmesg</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   35000 Aug 21 06:39 <span class="built_in">echo</span></span><br><span class="line">-rwxrwxrwx 1 aijm aijm   51512 Aug 21 06:39 ed</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  133792 Aug 21 06:39 ls</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   80056 Aug 21 06:39 mkdir</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   38952 Aug 21 06:39 more</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  137440 Aug 21 06:39 mv</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  423384 Aug 21 06:39 tar</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   88280 Aug 21 06:39 touch</span><br><span class="line">-rwxrwxrwx 1 aijm aijm 1113504 Aug 21 06:37 bash</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   63672 Aug 21 06:37 chgrp</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  219528 Aug 21 06:37 grep</span><br><span class="line">-rwxrwxrwx 1 aijm aijm    2301 Aug 21 06:37 gunzip</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   26704 Aug 21 06:37 <span class="built_in">kill</span></span><br><span class="line">-rwxrwxrwx 1 aijm aijm  170760 Aug 21 06:37 less</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  245872 Aug 21 06:37 nano</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   63704 Aug 21 06:37 rm</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  109000 Aug 21 06:37 sed</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   35032 Aug 21 06:37 uname</span><br><span class="line">-rwxrwxrwx 1 aijm aijm     946 Aug 21 06:37 <span class="built_in">which</span></span><br><span class="line">-rwxrwxrwx 1 aijm aijm   35064 Aug 21 06:35 cat</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  141528 Aug 21 06:35 cp</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  100568 Aug 21 06:35 date</span><br><span class="line">-rwxrwxrwx 1 aijm aijm  101560 Aug 21 06:35 gzip</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   67808 Aug 21 06:35 ln</span><br><span class="line">-rwxrwxrwx 1 aijm aijm   35000 Aug 21 06:35 <span class="built_in">pwd</span></span><br><span class="line">-rwxrwxrwx 1 aijm aijm   35000 Aug 21 06:35 sleep</span><br></pre></td></tr></table></figure></p><p>可以看到，有<strong>dog</strong>和<strong>sudo</strong>的更改发生在入侵之后。</p><p>入侵者往往不会仅仅简单的修改程序、植入程序，还常常修改配置文件，使某些用户登录后自动执行这些程序。user目录下的init.d目录有许多程序，这些程序会在用户登录后自启动，所以需要查看这些程序中是否包含之前的可疑程序。</p><h3 id="任务3-找出各个用户init-d目录下可能被污染的程序"><a href="#任务3-找出各个用户init-d目录下可能被污染的程序" class="headerlink" title="任务3: 找出各个用户init.d目录下可能被污染的程序"></a>任务3: 找出各个用户init.d目录下可能被污染的程序</h3><p>方法是找出所有文件中包含<code>&quot;dog&quot;,&quot;sudo&quot;</code>字符串的位置。</p><h4 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h4><p>grep 是一个非常强大的文本搜索工具，常见用法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Grep选项：</span><br><span class="line">* : 表示当前目录所有文件，也可以是某个文件名</span><br><span class="line">-r 是递归查找</span><br><span class="line">-n 是显示行号</span><br><span class="line">-R 查找所有文件包含子目录</span><br><span class="line">-i 忽略大小写</span><br><span class="line"></span><br><span class="line">有意思的命令行参数：</span><br><span class="line">grep -E &apos;123|abc&apos; filename : 找出文件（filename）中包含123或者包含abc的行</span><br><span class="line">grep -i pattern files ：不区分大小写地搜索。默认情况区分大小写</span><br><span class="line">grep -l pattern files ：只列出匹配的文件名,不列出路径</span><br><span class="line">grep -L pattern files ：列出不匹配的文件名</span><br><span class="line">grep -w pattern files ：只匹配整个单词，而不是字符串的一部分（如匹配‘magic’，而不是‘magical’）</span><br><span class="line">grep -C number pattern files ：匹配的上下文分别显示[number]行</span><br><span class="line">grep pattern1 | pattern2 files ：显示匹配 pattern1 或 pattern2 的行</span><br><span class="line">grep pattern1 files | grep pattern2 ：显示既匹配 pattern1 又匹配 pattern2 的行</span><br></pre></td></tr></table></figure></p><p>所以，可以运行如下命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aijm@DESKTOP-R8SS06A:/mnt/d/学习/cs61c/lab00/user$ grep -E -rn <span class="string">'dog|sudo'</span> ./</span><br><span class="line">./crealex/init.d/dbus:69:  dog</span><br><span class="line">./konotacja/init.d/networking:49:           sudo log_failure_msg <span class="string">"can't create <span class="variable">$RUN_DIR</span>"</span></span><br><span class="line">./oeufmayo/init.d/x11-common:98:    dog</span><br><span class="line">./Qondanisa/init.d/networking:169:      dog</span><br><span class="line">./Thiesi/init.d/rsync:87:    sudo dog</span><br></pre></td></tr></table></figure></p><p>则找出了包含<code>&quot;dog&quot;,&quot;sudo&quot;</code>的位置。</p><h3 id="任务4-删除这些文件，或文件中有问题的行"><a href="#任务4-删除这些文件，或文件中有问题的行" class="headerlink" title="任务4: 删除这些文件，或文件中有问题的行"></a>任务4: 删除这些文件，或文件中有问题的行</h3><h4 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h4><blockquote><p>转载自<a href="https://blog.csdn.net/xj626852095/article/details/26101273" target="_blank" rel="noopener">Linux Shell中删除和替换文件中某一行的方法</a></p></blockquote><p>sed是一个很好的文件处理工具，本身是一个管道命令，主要是以行为单位进行处理，可以将数据行进行替换、删除、新增、选取等特定工作，下面先了解一下sed的用法<br>sed命令行格式为：<br>         sed [-nefri] ‘command’ 输入文本        </p><p>常用选项：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-n∶使用安静(silent)模式。在一般 sed 的用法中，所有来自 STDIN的资料一般都会被列出到萤幕上。但如果加上 -n 参数后，则只有经过sed 特殊处理的那一行(或者动作)才会被列出来。</span><br><span class="line">-e∶直接在指令列模式上进行 sed 的动作编辑；</span><br><span class="line">-f∶直接将 sed 的动作写在一个档案内， -f filename 则可以执行 filename 内的sed 动作；</span><br><span class="line">-r∶sed 的动作支援的是延伸型正规表示法的语法。(预设是基础正规表示法语法)</span><br><span class="line">-i∶直接修改读取的档案内容，而不是由屏幕输出。</span><br></pre></td></tr></table></figure></p><p>常用命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a   ∶新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)～</span><br><span class="line">c   ∶取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！</span><br><span class="line">d   ∶删除</span><br><span class="line">i   ∶插入， i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；</span><br><span class="line">p   ∶列印，亦即将某个选择的资料印出。通常 p 会与参数 sed -n 一起运作</span><br><span class="line">s   ∶取代，可以直接进行取代！通常这个 s 的动作可以搭配正规表示法！例如 1,20s/old/new/g 就是啦！</span><br></pre></td></tr></table></figure></p><p>所以可以通过以下命令进行删除之前查找到的行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &apos;69d&apos; ./crealex/init.d/dbus</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> learn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cs61c </tag>
            
            <tag> linux </tag>
            
            <tag> diff,sdiff </tag>
            
            <tag> grep </tag>
            
            <tag> stat </tag>
            
            <tag> sed </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>JDK and JRE, java.lang.UnsupportedClassVersionError</title>
      <link href="/2018/12/21/JDK-and-JRE/"/>
      <url>/2018/12/21/JDK-and-JRE/</url>
      
        <content type="html"><![CDATA[<p>今天我下载了jdk 11.0.1,一番配置后，运行简单的程序时时出现了<code>java.lang.UnsupportedClassVersionError</code>的错误，错误信息如下：</p><h3 id="错误信息"><a href="#错误信息" class="headerlink" title="错误信息"></a>错误信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ajm@DESKTOP-R8SS06A MINGW64 /d/学习/cs61b</span><br><span class="line">$ java HelloWorld</span><br><span class="line">Error: A JNI error has occurred, please check your installation and try again</span><br><span class="line">Exception in thread &quot;main&quot; java.lang.UnsupportedClassVersionError: HelloWorld has been compiled by a more recent version of the Java Runtime (class file version 55.0), this version of the Java Runtime only recognizes class file versions up to 52.0</span><br><span class="line">        at java.lang.ClassLoader.defineClass1(Native Method)</span><br><span class="line">        at java.lang.ClassLoader.defineClass(Unknown Source)</span><br><span class="line">        at java.security.SecureClassLoader.defineClass(Unknown Source)</span><br><span class="line">        at java.net.URLClassLoader.defineClass(Unknown Source)</span><br><span class="line">        at java.net.URLClassLoader.access$100(Unknown Source)</span><br><span class="line">        at java.net.URLClassLoader$1.run(Unknown Source)</span><br><span class="line">        at java.net.URLClassLoader$1.run(Unknown Source)</span><br><span class="line">        at java.security.AccessController.doPrivileged(Native Method)</span><br><span class="line">        at java.net.URLClassLoader.findClass(Unknown Source)</span><br><span class="line">        at java.lang.ClassLoader.loadClass(Unknown Source)</span><br><span class="line">        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)</span><br><span class="line">        at java.lang.ClassLoader.loadClass(Unknown Source)</span><br><span class="line">        at sun.launcher.LauncherHelper.checkAndLoadMain(Unknown Source)</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>由错误信息可以知道，是由于高版本的JDK(Java Development Kit),编译产生的.class文件在低版本的JRE(Java Runtime Environment) 无法运行而报错。JDK是用于java程序开发的工具包，包含javac编译器、jar打包工具等。JRE是能够让计算机运行java程序的软件包,比如java HelloWorld,执行HelloWorld程序。</p><h4 id="查看JDK-JRE版本"><a href="#查看JDK-JRE版本" class="headerlink" title="查看JDK,JRE版本"></a>查看JDK,JRE版本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ajm@DESKTOP-R8SS06A MINGW64 /d/学习/cs61b</span><br><span class="line">$ java -version</span><br><span class="line">java version <span class="string">"1.8.0_171"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_171-b11)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.171-b11, mixed mode)</span><br><span class="line"></span><br><span class="line">ajm@DESKTOP-R8SS06A MINGW64 /d/学习/cs61b</span><br><span class="line">$ javac -version</span><br><span class="line">javac 11.0.1</span><br></pre></td></tr></table></figure><p>发现JRE是老的版本，于是我直接删除了这个老的版本。但是发现运行时出了问题：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ajm@DESKTOP-R8SS06A MINGW64 /d/学习/cs61b</span><br><span class="line">$ java -version</span><br><span class="line">bash: /c/Program Files (x86)/Common Files/Oracle/Java/javapath/java: No such file or directory</span><br></pre></td></tr></table></figure></p><p>这是因为环境变量中的路径问题，直接在PATH中删除老版本java的路径，就能正确找到java 11.0.1这个版本。</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> error </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>error C2589: (: ::右边的非法标记</title>
      <link href="/2018/11/25/error-C2589-%E5%8F%B3%E8%BE%B9%E7%9A%84%E9%9D%9E%E6%B3%95%E6%A0%87%E8%AE%B0/"/>
      <url>/2018/11/25/error-C2589-%E5%8F%B3%E8%BE%B9%E7%9A%84%E9%9D%9E%E6%B3%95%E6%A0%87%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<blockquote><p>原文：<a href="https://blog.csdn.net/zhuangshn/article/details/5537499" target="_blank" rel="noopener">https://blog.csdn.net/zhuangshn/article/details/5537499</a> </p></blockquote><h2 id="error-C2589-“-”-“-”右边的非法标记"><a href="#error-C2589-“-”-“-”右边的非法标记" class="headerlink" title="error C2589: “(”: “::”右边的非法标记"></a>error C2589: “(”: “::”右边的非法标记</h2><ol><li><p>错误输出<br> error C2589: “(”: “::”右边的非法标记</p><p> error C2059: 语法错误 : “::”</p></li><li><p>错误代码举例</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">num_choices = std::max(1, std::min(26, num_choices));</span><br></pre></td></tr></table></figure></li><li><p>函数模板max   </p><p>注：模板就是实现代码重用机制的一种工具，它可以实现类型参数化，即把类型定义为参数， 从而实现了真正的代码可重用性。模版可以分为两类，一个是函数模版，另外一个是类模版。</p></li><li><p>错误原因</p><p>函数模板max与Visual C++中的全局的宏max冲突。 </p></li><li><p>解决办法</p><p> 第一种办法：设置项目属性，在预定义处理器中添加定义<code>NOMINMAX</code>来禁止使用Vsual C++的min/max宏定义。</p><p> 项目属性   ——&gt; C/C++ ——&gt; 预处理器 ——&gt; 预处理器定义 (此处添加预定义编译开关   NOMINMAX）</p><p> 第二种办法： 加上括号，与Vsual C++的min/max宏定义区分开</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">num_choices = (std::max)(1, std::min(26, num_choices));</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> error </category>
          
      </categories>
      
      
        <tags>
            
            <tag> error </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cmake find_path(),windows带空格的路径</title>
      <link href="/2018/11/25/cmake-find-path-windows%E5%B8%A6%E7%A9%BA%E6%A0%BC%E7%9A%84%E8%B7%AF%E5%BE%84/"/>
      <url>/2018/11/25/cmake-find-path-windows%E5%B8%A6%E7%A9%BA%E6%A0%BC%E7%9A%84%E8%B7%AF%E5%BE%84/</url>
      
        <content type="html"><![CDATA[<p>cmake中的windows 路径如果有空格，比如<code>D:/Program Files/libigl</code>, 需要改成<code>D:/Program\ Files/libigl</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">find_path(LIBIGL_INCLUDE_DIR igl/readOBJ.h</span><br><span class="line">    HINTS</span><br><span class="line">        ENV LIBIGL</span><br><span class="line">        ENV LIBIGLROOT</span><br><span class="line">        ENV LIBIGL_ROOT</span><br><span class="line">        ENV LIBIGL_DIR</span><br><span class="line">    PATHS</span><br><span class="line">        $&#123;CMAKE_SOURCE_DIR&#125;/../..</span><br><span class="line">        $&#123;CMAKE_SOURCE_DIR&#125;/..</span><br><span class="line">        $&#123;CMAKE_SOURCE_DIR&#125;</span><br><span class="line">        $&#123;CMAKE_SOURCE_DIR&#125;/libigl</span><br><span class="line">        $&#123;CMAKE_SOURCE_DIR&#125;/../libigl</span><br><span class="line">        $&#123;CMAKE_SOURCE_DIR&#125;/../../libigl</span><br><span class="line">        D:/Program\ Files/libigl</span><br><span class="line">        /usr</span><br><span class="line">        /usr/local</span><br><span class="line">        /usr/local/igl/libigl</span><br><span class="line">    PATH_SUFFIXES include</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> error </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cmake </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>hadoop集群搭建</title>
      <link href="/2018/09/26/hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/"/>
      <url>/2018/09/26/hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="hadoop-集群搭建"><a href="#hadoop-集群搭建" class="headerlink" title="hadoop 集群搭建"></a>hadoop 集群搭建</h1><p>实验室当前hadoop集群节点如下：</p><table><thead><tr><th>主机名</th><th>用户名</th><th>IP</th><th>集群中的角色</th></tr></thead><tbody><tr><td>master</td><td>hadoop</td><td>10.13.61.122</td><td>NameNode、JobTracker</td></tr><tr><td>slave1</td><td>hadoop</td><td>10.13.61.125</td><td>DataNode、TaskTracker</td></tr><tr><td>slave2</td><td>hadoop</td><td>10.13.61.132</td><td>DataNode、TaskTracker</td></tr><tr><td>slave3</td><td>hadoop</td><td>10.13.61.146</td><td>DataNode、TaskTracker</td></tr><tr><td>slave4</td><td>hadoop</td><td>10.13.61.144</td><td>DataNode、TaskTracker</td></tr><tr><td>slave5</td><td>hadoop</td><td>10.13.61.143</td><td>DataNode、TaskTracker</td></tr><tr><td>slave6</td><td>hadoop</td><td>10.13.61.147</td><td>DataNode、TaskTracker</td></tr><tr><td>ajm-zju</td><td>hadoop</td><td>10.13.61.129</td><td>DataNode、TaskTracker</td></tr></tbody></table><p>各个节点的用户名均设置为 <strong>hadoop</strong>,密码均为 <strong>123456</strong>。其中slave3,slave4目前一般不使用。</p><p>hadoop集群安装主要有以下几个步骤：</p><ol><li>环境配置(host设置，ssh免密登录，Java安装等)</li><li>hadoop安装及修改配置文件</li><li>运行及测试</li></ol><a id="more"></a><h2 id="一、环境配置"><a href="#一、环境配置" class="headerlink" title="一、环境配置"></a>一、环境配置</h2><h3 id="1-用户、主机名、hosts文件"><a href="#1-用户、主机名、hosts文件" class="headerlink" title="1. 用户、主机名、hosts文件"></a>1. 用户、主机名、hosts文件</h3><p>由于目前已经搭建好的hadoop集群的用户名均为hadoop，所以需要在Ubuntu系统上新建一个hadoop用户，步骤如下：</p><h4 id="创建hadoop操作用户"><a href="#创建hadoop操作用户" class="headerlink" title="创建hadoop操作用户"></a>创建hadoop操作用户</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd -m hadoop -s /bin/bash</span><br></pre></td></tr></table></figure><h4 id="给hadoop用户添加密码"><a href="#给hadoop用户添加密码" class="headerlink" title="给hadoop用户添加密码"></a>给hadoop用户添加密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd hadoop</span><br></pre></td></tr></table></figure><p>输入密码后回车，密码在输入时是不可见的。</p><h4 id="给hadoop用户分配sudo权限"><a href="#给hadoop用户分配sudo权限" class="headerlink" title="给hadoop用户分配sudo权限"></a>给hadoop用户分配sudo权限</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo adduser hadoop sudo</span><br></pre></td></tr></table></figure><p>注销或重启系统，以hadoop用户登录</p><h4 id="切换用户"><a href="#切换用户" class="headerlink" title="切换用户"></a>切换用户</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su &lt;用户名&gt;，例如 su hadoop; su ajm</span><br></pre></td></tr></table></figure><p>输入要切换的用户密码，即可切换。</p><h4 id="安装vim、gedit"><a href="#安装vim、gedit" class="headerlink" title="安装vim、gedit"></a>安装vim、gedit</h4><p>vim是命令行编辑工具，gedit是图形界面编辑器，不习惯vim的话建议使用gedit<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install vim</span><br><span class="line">sudo apt-get install gedit</span><br></pre></td></tr></table></figure></p><h4 id="修改主机名"><a href="#修改主机名" class="headerlink" title="修改主机名"></a>修改主机名</h4><p><strong>不想修改主机名可以跳过此步，不会有影响</strong></p><p>在终端中输入hostname可以查看当前主机名，如下图：<br><img src="/images/1.jpg" alt=""><br>实际上在终端中有 <strong>hadoop@ajm-zju</strong>，其中hadoop是用户名，ajm-zju是主机名<br>比如要把新的主机加入集群，为了名称统一，可以将主机名改为 <strong>slave7</strong>,只需：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo hostname slave7 #暂时生效，重启后会失效</span><br><span class="line">sudo gedit /etc/hostname</span><br></pre></td></tr></table></figure></p><p>在文件中修改为slave7即可</p><h4 id="查看本机ip地址"><a href="#查看本机ip地址" class="headerlink" title="查看本机ip地址"></a>查看本机ip地址</h4><p>终端中输入以下命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br></pre></td></tr></table></figure></p><p><img src="/images/ip.jpg" alt=""><br>图中的 <strong>inet地址: 10.13.61.129</strong> 即为本机ip地址。</p><h4 id="配置hosts"><a href="#配置hosts" class="headerlink" title="配置hosts"></a>配置hosts</h4><p>/etc/hosts文件里维护了主机名和ip地址的映射关系，这样可以直接通过主机名通信，不用每次输入复杂的ip地址。通过cat命令可以直接在命令行中查看文件内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cat /etc/hosts</span><br></pre></td></tr></table></figure></p><p>在我的主机上，结果如下：<br><img src="/images/hosts.jpg" alt=""><br>可以hosts文件中保存了hadoop集群中其他主机的 <strong>ip地址<->主机名</-></strong> 映射关系，这样在hadoop进行通信时，可以直接通过主机名访问。所以如果集群加入新的主机，需要在新主机上修改hosts文件如上图，并加上本机地址映射<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/hosts</span><br></pre></td></tr></table></figure></p><p>终端中输入以上命令进行修改</p><h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><p>如果配置成功，通过 <strong>ping</strong> 测试时，可以直接通过主机名而不需要ip地址<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ping master</span><br><span class="line">ping slave1</span><br><span class="line">ping 其他主机</span><br></pre></td></tr></table></figure></p><p>成功时结果如下：<br><img src="/images/ping.jpg" alt=""><br>注：ping指令会一直执行，可以通过 <code>ctrl+C</code> 停止</p><h3 id="2-配置SSH免密登录"><a href="#2-配置SSH免密登录" class="headerlink" title="2. 配置SSH免密登录"></a>2. 配置SSH免密登录</h3><p>由于hadoop集群中master主机需要调度各个slave，而这需要配置ssh远程登录服务。</p><h4 id="安装ssh"><a href="#安装ssh" class="headerlink" title="安装ssh"></a>安装ssh</h4><p>ubuntu 默认安装了ssh 客户端，没有安装服务端。运行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -e|grep ssh</span><br></pre></td></tr></table></figure></p><p>结果应该与下文类似：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop@ajm-zju:/home/ajm$ ps -e|grep ssh</span><br><span class="line"> 1444 ?        00:00:00 sshd</span><br></pre></td></tr></table></figure></p><p>如果没有 <code>sshd</code> ，则说明没有安装ssh服务端，可以输入以下命令安装：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openssh-server</span><br></pre></td></tr></table></figure></p><h4 id="ssh登录其他主机"><a href="#ssh登录其他主机" class="headerlink" title="ssh登录其他主机"></a>ssh登录其他主机</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh master</span><br></pre></td></tr></table></figure><p>出现身份警告时，输入yes并回车，需要输入密码时，请输入master主机的密码。<br>之后就登录了master主机，可以通过命令行操作maseter主机。<br><img src="/images/ssh.jpg" alt=""><br>注：退出登录使用<code>exit</code> 命令。</p><h4 id="生成RSA公私钥对"><a href="#生成RSA公私钥对" class="headerlink" title="生成RSA公私钥对"></a>生成RSA公私钥对</h4><p>但是每次ssh登录都需要输入密码太麻烦，所以可以通过公私钥的方式免密登录，配置方法是 <strong>A主机将公钥加入到B主机的authorized_keys中</strong>, 则A可以免密登录B。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa # 一路回车</span><br><span class="line">cd ~/.ssh # 公私钥对保存在此目录</span><br><span class="line">ls # 查看目录中的文件列表</span><br></pre></td></tr></table></figure></p><p>终端中输入以上命令后,可以看到有 id_rsa(私钥),id_rsa.pub(公钥)。<br>则将id_rsa.pub追加到master主机的authorized_keys中，则当前主机可以免密登录master主机。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub master</span><br></pre></td></tr></table></figure></p><p>如需要输入密码则输入master主机的密码</p><h4 id="ssh免密登录测试"><a href="#ssh免密登录测试" class="headerlink" title="ssh免密登录测试"></a>ssh免密登录测试</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh master</span><br></pre></td></tr></table></figure><p>如果直接登录成功，则配置正确。<br>登录master后，由于master主机已经生成了公私钥对，可以将master的公钥发给当前主机,实现master对当前主机的ssh免密登录。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub &lt;hostname&gt;</span><br></pre></td></tr></table></figure></p><p>如果出现错误，则需要在master主机中修改/etc/hosts，添加新主机的 ip<->hostname 映射。</-></p><h3 id="3-java安装"><a href="#3-java安装" class="headerlink" title="3. java安装"></a>3. java安装</h3><p>下载 <code>jdk-8u101.linux-x64.tar.gz</code>,运行以下命令解压到/usr目录下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /usr/java</span><br><span class="line">sudo tar -zxvf jdk-8u101.linux-x64.tar.gz -C /usr/java</span><br><span class="line">cd /usr/java/jdk1.8.0_101/bin</span><br><span class="line">./java -version #查看java版本</span><br></pre></td></tr></table></figure></p><p><img src="/images/java.jpg" alt=""><br>出现上图结果则正确安装</p><h4 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h4><p>在前面是通过<code>./java</code> 执行java可执行程序，但是为了执行这个程序，必须每次都切换到<code>/usr/java/jdk1.8.0_101/bin</code>目录下，为了能在任何目录下都能执行java的相关程序，需要配置环境变量。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/profile</span><br></pre></td></tr></table></figure></p><p>在/etc/profile文件末尾添加如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_101</span><br><span class="line">export JRE_HOME=/usr/java/jdk1.8.0_101/jre</span><br><span class="line">export CLASSPATH=$CLASSPATH:$JAVA_HOME/lib:$JRE_HOME/lib</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br></pre></td></tr></table></figure></p><p>保存后退出。通过<code>source</code>命令使得上面的修改生效。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></p><p>输入以下命令测试是否成功配置环境变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure></p><p><img src="/images/java1.jpg" alt=""><br>出现以上结果则成功配置。</p><h2 id="二、Hadoop安装"><a href="#二、Hadoop安装" class="headerlink" title="二、Hadoop安装"></a>二、Hadoop安装</h2><h3 id="1-安装及环境变量配置"><a href="#1-安装及环境变量配置" class="headerlink" title="1. 安装及环境变量配置"></a>1. 安装及环境变量配置</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>将hadoop-2.6.0.tar.gz解压到目录/opt<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf hadoop-2.6.0.tar.gz -C /opt # 解压到/opt</span><br><span class="line">cd /opt      # 切到含有hadoop-2.6.0的目录下</span><br><span class="line">sudo chown -R hadoop:hadoop ./hadoop-2.6.0       # 修改文件权限</span><br></pre></td></tr></table></figure></p><h4 id="配置环境变量-1"><a href="#配置环境变量-1" class="headerlink" title="配置环境变量"></a>配置环境变量</h4><p>与java配置环境变量相同，在/etc/profile中追加：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export HADOOP_HOME=/opt/hadoop-2.6.0</span><br><span class="line">export HADOOP_LIB_NATIVE=$HADOOP_HOME/lib/native</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/bin</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/sbin</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/lib</span><br></pre></td></tr></table></figure></p><p>保存后退出。通过<code>source</code>命令使得上面的修改生效。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></p><p>输入以下命令测试是否成功配置环境变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop version</span><br></pre></td></tr></table></figure></p><p><img src="/images/hadoop_v.jpg" alt=""><br>出现以上结果则成功配置。</p><h3 id="2-配置参数"><a href="#2-配置参数" class="headerlink" title="2. 配置参数"></a>2. 配置参数</h3><p>需要对所有的集群节点配置参数，其中大部分文件都是相同的，可以配置一个之后直接复制覆盖相关文件，而比如不同主机java安装路径不同的话，需要复制之后修改hadoop-env.sh和yarn-env.sh的相关参数。<br>hadoop需要配置一些参数才能成功运行，这些配置文件都在<code>/opt/hadoop-2.6.0/etc/hadoop/</code> 目录下。</p><h4 id="hadoop-env-sh-and-yarn-env-sh"><a href="#hadoop-env-sh-and-yarn-env-sh" class="headerlink" title="hadoop-env.sh and yarn-env.sh"></a>hadoop-env.sh and yarn-env.sh</h4><p>在<code>hadoop-env.sh</code>和<code>yarn-env.sh</code>中需要指定java安装目录。在文件末尾追加以下内容即可：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_101</span><br></pre></td></tr></table></figure></p><h4 id="slaves"><a href="#slaves" class="headerlink" title="slaves"></a>slaves</h4><p>slaves文件需要添加所有的slave节点主机名如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">slave1</span><br><span class="line">slave2</span><br><span class="line">slave3</span><br><span class="line">slave4</span><br><span class="line">slave5</span><br><span class="line">slave6</span><br><span class="line">ajm-zju</span><br><span class="line">&lt;Your hostname&gt;</span><br></pre></td></tr></table></figure></p><h4 id="core-site-xml"><a href="#core-site-xml" class="headerlink" title="core-site.xml"></a>core-site.xml</h4><p>添加以下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;hdfs://master:8020&lt;/value&gt;</span><br><span class="line">      &lt;description&gt;&lt;/description&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;io.file.buffer.size&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;131072&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;/opt/hadoop-2.6.0/tmp&lt;/value&gt;</span><br><span class="line">      &lt;description&gt;A base for other temporary directories.&lt;/description&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p><h4 id="hdfs-site-xml"><a href="#hdfs-site-xml" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h4><p>这个文件配置hdfs文件系统相关参数，添加以下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;3&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;file:/opt/hadoop-2.6.0/dfs/name&lt;/value&gt;</span><br><span class="line">      &lt;description&gt;namenode上存储hdfs name空间元数据&lt;/description&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;file:/opt/hadoop-2.6.0/dfs/data&lt;/value&gt;</span><br><span class="line">      &lt;description&gt;datanode上数据块的物理存储位置&lt;/description&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;master:50090&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;true&lt;/value&gt;    </span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;dfs.permissions&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;false&lt;/value&gt;    </span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p><h4 id="mapred-site-xml"><a href="#mapred-site-xml" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h4><p>这个文件配置mapreduce任务相关参数。首先需要重命名mapred-site.xml.template文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv ./mapred-site.xml.template mapred-site.xml</span><br></pre></td></tr></table></figure></p><p>然后将以下内容添加到 mapred-site.xml:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">       &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">       &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">   &lt;property&gt;</span><br><span class="line">       &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;</span><br><span class="line">       &lt;value&gt;master:10020&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   </span><br><span class="line">   &lt;property&gt;</span><br><span class="line">       &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;</span><br><span class="line">       &lt;value&gt;master:19888&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">   &lt;property&gt;</span><br><span class="line">       &lt;name&gt;mapreduce.jobhistory.itermediate-done-dir&lt;/name&gt;  </span><br><span class="line">       &lt;value&gt;$&#123;hadoop.tmp.dir&#125;/mr-history/tmp&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">  </span><br><span class="line">   &lt;property&gt;</span><br><span class="line">       &lt;name&gt;mapreduce.jobhistory.done-dir&lt;/name&gt;</span><br><span class="line">       &lt;value&gt;$&#123;hadoop.tmp.dir&#125;/mr-history/done&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line"> </span><br><span class="line">   &lt;property&gt;</span><br><span class="line">    &lt;name&gt;mapreduce.jobtracker.staging.root.dir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;/user&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p><h4 id="yarn-site-xml"><a href="#yarn-site-xml" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h4><p>这个文件配置yarn资源管理调度的相关参数,添加以下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.nodemanager.aux-services.mapreduce.shuffle.class&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;org.apache.hadoop.mapred.ShuffleHandler&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.resourcemanager.address&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;master:8032&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.resourcemanager.scheduler.address&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;master:8030&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.resourcemanager.resource-tracker.address&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;master:8035&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.resourcemanager.admin.address&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;master:8033&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt; </span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;master:8088&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">   &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.app.mapreduce.am.staging-dir&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;/user&lt;/value&gt;</span><br><span class="line">   &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.nodemanager.resource.memory-mb&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;20480&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.scheduler.minimum-allocation-mb&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;2048&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;yarn.nodemanager.vmem-pmem-ratio&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;2.1&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p><h2 id="三、-运行及测试"><a href="#三、-运行及测试" class="headerlink" title="三、 运行及测试"></a>三、 运行及测试</h2><p>ssh登录master主机后，进行以下操作。</p><h3 id="格式化分布式文件系统-已有hadoop系统请跳过这一步"><a href="#格式化分布式文件系统-已有hadoop系统请跳过这一步" class="headerlink" title="格式化分布式文件系统(已有hadoop系统请跳过这一步)"></a>格式化分布式文件系统(已有hadoop系统请跳过这一步)</h3><font color="#FF0000" size="4">只有在第一次搭建hadoop系统时需要进行格式化操作，请不要在已有的hadoop系统上格式化，这会删除所有的数据！！！!</font><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure><h3 id="运行文件系统管理器hdfs"><a href="#运行文件系统管理器hdfs" class="headerlink" title="运行文件系统管理器hdfs"></a>运行文件系统管理器hdfs</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-dfs.sh</span><br></pre></td></tr></table></figure><h3 id="运行任务调度管理器yarn"><a href="#运行任务调度管理器yarn" class="headerlink" title="运行任务调度管理器yarn"></a>运行任务调度管理器yarn</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-yarn.sh</span><br></pre></td></tr></table></figure><h3 id="查看相关进程"><a href="#查看相关进程" class="headerlink" title="查看相关进程"></a>查看相关进程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br></pre></td></tr></table></figure><p>在master中可以看到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[hadoop@master ~]$ jps</span><br><span class="line">5859 SecondaryNameNode</span><br><span class="line">6003 ResourceManager</span><br><span class="line">6293 Jps</span><br><span class="line">24991 JobHistoryServer</span><br><span class="line">5695 NameNode</span><br></pre></td></tr></table></figure></p><p>在各个slave中可以看到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hadoop@ajm-zju:/$ jps</span><br><span class="line">28976 DataNode</span><br><span class="line">31952 NodeManager</span><br><span class="line">32158 Jps</span><br></pre></td></tr></table></figure></p><h3 id="Web查看信息"><a href="#Web查看信息" class="headerlink" title="Web查看信息"></a>Web查看信息</h3><p>在web上可以看到集群启动的信息：</p><ul><li>查看hdfs: <a href="master:50070" target="_blank" rel="noopener">master:50070</a></li><li>查看resourcemanager: <a href="master:8088" target="_blank" rel="noopener">master:8088</a></li></ul><p>如果web页面访问不了，可能是master主机的防火墙未关闭, ssh登录master主机,运行以下命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status firewalld.service # 查看防火墙状态</span><br></pre></td></tr></table></figure></p><p><img src="/images/wall.jpg" alt=""><br>若图中的Active:显示为active，则需要关闭防火墙。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop firewalld.service # 关闭防火墙</span><br></pre></td></tr></table></figure></p><p>关闭后重新访问页面即可。</p><h3 id="关闭hadoop"><a href="#关闭hadoop" class="headerlink" title="关闭hadoop"></a>关闭hadoop</h3><p>执行相反的操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stop-yarn.sh</span><br><span class="line">stop-dfs.sh</span><br></pre></td></tr></table></figure></p><blockquote><p>本文引用了以下内容</p><ul><li><a href="https://www.jianshu.com/p/4e0dc91ad86e" target="_blank" rel="noopener">Hadoop真分布式集群最速搭建攻略</a></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
